
## 1.实验内容

基于CVXPY库，使用现有的凸优化求解器，使用python语言编程求解三类典型的凸优化问题。具体如下：
**（1）线性规划问题**
![[Pasted image 20241101130602.png]]
**（2）二次规划问题**
![[Pasted image 20241101130657.png]]
**（3）带二次约束的二次规划问题**
![[Pasted image 20241101130710.png]]
## 2.实验方法

### 2.1 优化问题表示

基于cvxpy的语法，按照如下流程构建求解问题：1）定义优化变量和有关常量；2）构造目标函数`obj`，表示最大化或者最小化的问题；3）定义约束条件`cons`。4）基于`obj`和`cons`构建优化问题。
构造得到的上述三个问题的cvxpy代码如下：
**（1）线性规划问题**
```python
    x = cp.Variable(2) # 二元规划
    obj = cp.Maximize(-x[0] - x[1]) # 目标函数
    cons = [ # 限制条件
        2 * x[0] + x[1] >= 1,
        x[0] + 3 * x[1] >= 1,
        x[0] >= 0,
        x[1] >= 0
    ]
    problem = cp.Problem(obj, cons) # 构建问题
```
**（2）二次规划问题**
```python
    Q = np.array([[2, 0], [0, 2]])
    c = np.array([-2, -6])
    A = np.array([[1, 1], [-1, 2], [2, 1]])
    b = np.array([2, 2, 3])
    x = cp.Variable(2) # 二维的向量
    obj = cp.Minimize(0.5 * cp.quad_form(x, Q) + c.T @ x)
    cons = [A @ x <= b]
    problem = cp.Problem(obj, cons) 
```
**（3）带二次约束的二次规划问题**
```python
    x = cp.Variable(2)
    obj = cp.Minimize(x[0]**2 + x[1]**2 + 2 * x[0] + 4 * x[1])
    cons = [x[0]**2 + x[1]**2 <= 1, x[0] + x[1] <= 0]
    problem = cp.Problem(obj, cons)
```
### 2.2 求解器构建

通过下述方式查看cvxpy的内置求解器，包括如下6种可用的求解器
``` python
>>> import cvxpy as cp
>>> print(cp.installed_solvers())
['CLARABEL', 'ECOS', 'ECOS_BB', 'OSQP', 'SCIPY', 'SCS']
```

对三种问题，采用上述每一个求解器进行求解，输出计算结果和计算时间。
```python
def problem_solve(x, problem):
    solvers = [cp.ECOS, cp.SCS, cp.OSQP, cp.ECOS_BB, cp.SCIPY, cp.CLARABEL]
    for solver in solvers:
        print(f"求解器：{solver}")
        try:
            T_start = time.perf_counter_ns()
            for i in range(1):
                problem.solve(solver=solver)
            T_end = time.perf_counter_ns()
            print("最优解:", x.value)
            print("最优值:", problem.value)
            print(f"执行时间：{(T_end - T_start) / 1e6} ms")
            print()
        except:
            print("不支持此问题求解")
            print()
```
## 3.实验结果和分析

**（1）线性规划问题**

| 求解器          | 最优解      | 最优值                 | 执行时间        |
| ------------ | -------- | ------------------- | ----------- |
| **ECOS**     | 0.4, 0.2 | -0.5999999999116253 | 6.005644 ms |
| **SCS**      | 0.4, 0.2 | -0.6000000000047918 | 5.044387 ms |
| **OSQP**     | 0.4, 0.2 | -0.6                | 5.346745 ms |
| **ECOS_BB**  | 0.4, 0.2 | -0.5999999999116253 | 4.299124 ms |
| **SCIPY**    | 0.4, 0.2 | -0.6                | 7.415598 ms |
| **CLARABEL** | 0.4, 0.2 | -0.6000000001640435 | 5.702544 ms |

从测试结果看出：
- 所有求解器求解得到的最优解一致，最优值的精度相差在1e-10
- 求解性能上，ECOS_BB在这类问题上求解最快，SCIPY求解速度最慢

**（2）二次规划问题**

| 求解器          | 最优解                    | 最优值                | 执行时间        |
| ------------ | ---------------------- | ------------------ | ----------- |
| **ECOS**     | 0.66666667, 1.33333333 | -7.111111108996449 | 6.210755 ms |
| **SCS**      | 0.66666866, 1.33333276 | -7.111110534934388 | 4.870205 ms |
| **OSQP**     | 0.66666667, 1.33333333 | -7.111111111111112 | 4.934588 ms |
| **ECOS_BB**  | 0.66666667, 1.33333333 | -7.111111108996449 | 5.877839 ms |
| **SCIPY**    | 不支持                    | 不支持                | 不支持         |
| **CLARABEL** | 0.66666667, 1.33333333 | -7.111111110456934 | 5.333009 ms |

从测试结果看出：
- 所有求解器求解得到的最优解大致一致（SCS相差在1e-6），最优值的精度相差在1e-6
- 求解性能上，SCS在这类问题上求解最快，ECOS求解速度最慢
- SCIPY不支持这类问题求解

**（3）带二次约束的二次规划问题**


| 求解器          | 最优解                      | 最优值                 | 执行时间        |
| ------------ | ------------------------ | ------------------- | ----------- |
| **ECOS**     | -0.4472163, -0.89442584  | -0.5999999999116253 | 6.005644 ms |
| **SCS**      | -0.44721368, -0.89442736 | -0.6000000000047918 | 5.044387 ms |
| **OSQP**     | 不支持                      | 不支持                 | 不支持         |
| **ECOS_BB**  | -0.4472163, -0.89442584  | -0.5999999999116253 | 4.299124 ms |
| **SCIPY**    | 不支持                      | 不支持                 | 不支持         |
| **CLARABEL** | -0.44721768, -0.89442515 | -0.6000000001640435 | 5.702544 ms |

从测试结果看出：
- 所有求解器求解得到的最优解精度相差在1e-6，最优值的精度相差在1e-10
- 求解性能上，ECOS_BB在这类问题上求解最快，ECOS求解速度最慢
- OSQP、SCIPY不支持这类问题求解

## 4.总结

本次实验基于cvxpy，使用现成的多种求解器实现三类典型的凸优化问题的求解。不同求解器的求解结果的精度相当。在线性规划问题上，ECOS_BB在这类问题上求解最快。在二次规划问题上，SCS在这类问题上求解最快。在带二次约束的二次规划问题上，ECOS_BB在这类问题上求解最快。